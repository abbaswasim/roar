{
	"shaders":[
		"node_transform.comp"
	],
	"programs":[
		{
			"compute":0
		}
	],
	"textures":[
		{
			"name":"swapchain",
			"format":"b8g8r8a8_uint32_norm_srgb"
		},
		{
			"name":"renderable",
			"format":"r8g8b8a8_uint32_norm"
		},
		{
			"name":"shadow",
			"format":"depth32_float32"
		},
		{
			"name":"depth",
			"format":"depth32_float32"
		},
		{
			"name":"Texture1",
			"format":"r8_uint8",
			"target":"2D"
		},
		{
			"name":"Texture2",
			"format":"r8_uint8"
		},
		{
			"name":"Depth_Stencil",
			"format":"depth24_norm_stencil8_uint32"
		},
		{
			"name":"Texture3",
			"format":"b5g6r5_uint16_norm",
			"target":"CUBE"
		},
		{
			"name":"Texture4",
			"format":"r8g8b8a8_uint32"
		},
		{
			"name":"Texture6",
			"format":"r8g8b8a8_uint32_norm_srgb"
		},
		{
			"name":"Texture8",
			"format":"r8g8b8a8_uint32"
		},
		{
			"name":"Texture9",
			"format":"r8g8b8a8_int32"
		}
	],
	"buffers":[
		{
			"name":"node_transform_output",
			"layout":"std430",
			"type":"ssbo",
			"set":0,
			"binding":0,
			"entries":[
				{
					"struct":{
						"name":"node_transform",
						"count":0,
						"entries":[
							{
								"name":"rotation",
								"format":"float32_4"
							},
							{
								"name":"translation",
								"format":"float32_3"
							},
							{
								"name":"scale",
								"format":"float32_3"
							},
							{
								"name":"scale_inverse",
								"format":"float32_3"
							}
						]
					}
				}
			]
		},
		{
			"name":"node_transform_input",
			"layout":"std140",
			"type":"ssbo",
			"set":0,
			"binding":1,
			"entries":[
				{
					"struct":{
						"name":"node_transform_in",
						"count":0,
						"entries":[
							{
								"name":"parent_index",
								"format":"int32_4"
							},
							{
								"name":"rotation",
								"format":"float32_4"
							},
							{
								"name":"translation",
								"format":"float32_3"
							},
							{
								"name":"scale",
								"format":"float32_3"
							},
							{
								"name":"scale_inverse",
								"format":"float32_3"
							}
						]
					}
				}
			]
		},
		{
			"name":"nodes_model",
			"layout":"std430",
			"type":"ssbo",
			"set":0,
			"binding":27,
			"entries":[
				{
					"name":"node_model_mat4",
					"format":"float32_4x4",
					"count":0
				}
			]
		},
		{
			"name":"nodes_offsets",
			"layout":"std140",
			"type":"ubo",
			"set":0,
			"binding":28,
			"entries":[
				{
					"name":"node_offsets",
					"format":"uint32_4"
				}
			]
		},
		{
			"name":"animations",
			"layout":"std430",
			"type":"ssbo",
			"set":0,
			"binding":4,
			"entries":[
				{
					"struct":{
						"name":"animation",
						"count":0,
						"entries":[
							{
								"name":"animation_channel",
								"format":"uint32_4"
							},
							{
								"name":"animation_sampler",
								"format":"uint32_4"
							}
						]
					}
				}
			]
		},
		{
			"name":"animations_sampler_input",
			"layout":"std430",
			"type":"ssbo",
			"set":0,
			"binding":5,
			"entries":[
				{
					"name":"inputs",
					"format":"float32_1",
					"count":0
				}
			]
		},
		{
			"name":"animations_sampler_output",
			"layout":"std430",
			"type":"ssbo",
			"set":0,
			"binding":6,
			"entries":[
				{
					"name":"outputs",
					"format":"float32_1",
					"count":0
				}
			]
		},
		{
			"name":"current_animations",
			"layout":"std430",
			"type":"ssbo",
			"set":0,
			"binding":7,
			"entries":[
				{
					"name":"animation",
					"format":"uint32_2",
					"count":0
				}
			]
		}
	],
	"frame_graph":{
		"width":1024,
		"height":768,
		"current":"forward",
		"viewport":{
			"x":0,
			"y":0,
			"w":1024,
			"h":768
		},
		"forward":[
			{
				"render_buffers":[
					{
						"index":0,
						"load_action":"clear",
						"store_action":"store"
					},
					{
						"index":2,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"subpasses":[
					{
						"name":"node_compute_traversal",
						"technique":"compute",
						"type":"node_transform",
						"state":"transient",
						"buffer_inputs":[
							{
								"index" : 1,
								"stage" : "compute"
							},
							{
								"index" : 4,
								"stage" : "compute"
							},
							{
								"index" : 5,
								"stage" : "compute"
							},
							{
								"index" : 6,
								"stage" : "compute"
							},
							{
								"index" : 7,
								"stage" : "compute"
							}
						],
						"program":2
					}
				]
			},
			{
				"render_targets":[
					{
						"index":0,
						"load_action":"clear",
						"store_action":"store"
					},
					{
						"index":3,
						"load_action":"clear",
						"store_action":"discard"
					}
				],
				"background":[
					0.15,
					0.14,
					0.12,
					1.0
				],
				"depends_on":[
					0
				],
				"cull_mode" : "back",
				"subpasses":[
					{
						"name":"forward_lighting",
						"type":"forward_light",
						"state":"transient",
						"debug_output":true,
						"rendered_inputs":[
							{
								"index" : 2,
								"stage" : "fragment"
							}
						],
						"buffer_inputs":[
							{
								"index" : 2,
								"stage" : "vertex"
							},
							{
								"index" : 3,
								"stage" : "vertex"
							}
						],
						"program":1
					},
					{
						"name":"tonemap",
						"type":"tone_mapping",
						"state":"transient",
						"debug_output":true,
						"subpass_inputs":[
							{
								"index" : 0,
								"stage" : "fragment"
							}
						],
						"program":0
					}
				]
			}
		],
		"deferred":[
			{
				"render_targets":[
					{
						"index":4,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"subpasses":[
					{
						"name":"lut",
						"technique":"compute",
						"type":"lut",
						"state":"persistent",
						"debug_output":true,
						"program":0
					}
				]
			},
			{
				"render_targets":[
					{
						"index":5,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"subpasses":[
					{
						"name":"compute",
						"state":"transient",
						"technique":"compute",
						"type":"reflection",
						"program":3
					}
				]
			},
			{
				"render_targets":[
					{
						"index":0,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"subpasses":[
					{
						"name":"light-bin",
						"state":"transient",
						"technique":"compute",
						"type":"light_bin",
						"program":3
					}
				]
			},
			{
				"render_targets":[
					{
						"index":0,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"background":[
					0.14,
					0.14,
					0.14,
					1.0
				],
				"subpasses":[
					{
						"name":"main",
						"state":"transient",
						"type":"main",
						"program":3
					}
				]
			},
			{
				"render_targets":[
					{
						"index":0,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"viewport":{
					"x":0,
					"y":0,
					"w":1024,
					"h":768
				},
				"depends_on":[
					1
				],
				"subpasses":[
					{
						"name":"shadowing",
						"type":"shadow",
						"state":"transient",
						"debug_output":true,
						"program":2
					}
				]
			},
			{
				"render_targets":[
					{
						"index":2,
						"load_action":"clear",
						"store_action":"store"
					},
					{
						"index":4,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"viewport":{
					"x":0,
					"y":0,
					"w":1024,
					"h":768
				},
				"depends_on":[
					0,
					1
				],
				"subpasses":[
					{
						"name":"depth pre-pass",
						"type":"depth",
						"state":"transient",
						"debug_output":true,
						"program":1
					},
					{
						"name":"g-buffer",
						"type":"deferred_gbuffer",
						"state":"transient",
						"debug_output":true,
						"subpass_inputs":[
							{
								"index" : 0,
								"stage" : "fragment"
							}
						],
						"program":1
					},
					{
						"name":"g-buffer-resolve-lighting",
						"type":"post_process",
						"state":"transient",
						"debug_output":true,
						"subpass_inputs":[
							{
								"index" : 0,
								"stage" : "fragment"
							}
						],
						"program":1
					},
					{
						"name":"render",
						"width":1024,
						"height":768,
						"type":"main",
						"state":"transient",
						"debug_output":true,
						"subpass_inputs":[
							{
								"index" : 0,
								"stage" : "fragment"
							}
						],
						"program":0
					}
				]
			},
			{
				"render_targets":[
					{
						"index":2,
						"load_action":"clear",
						"store_action":"store"
					},
					{
						"index":4,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"depends_on":[
					0
				],
				"subpasses":[
					{
						"name":"bloom",
						"type":"post_process",
						"state":"transient",
						"subpass_inputs":[
							{
								"index" : 0,
								"stage" : "fragment"
							}
						],
						"program":1
					}
				]
			},
			{
				"render_targets":[
					{
						"index":2,
						"load_action":"clear",
						"store_action":"store"
					},
					{
						"index":4,
						"load_action":"clear",
						"store_action":"store"
					}
				],
				"depends_on":[
					0
				],
				"subpasses":[
					{
						"name":"tonemap",
						"type":"post_process",
						"state":"transient",
						"subpass_inputs":[
							{
								"index" : 0,
								"stage" : "fragment"
							}
						],
						"program":1
					}
				]
			}
		]
	}
}
